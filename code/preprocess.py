# -*- coding: utf-8 -*-
import matplotlib
import matplotlib.pyplot as plt
import seaborn as sns
import pandas as pd
import joblib
import numpy as np
import math
import os
from collections import Counter

lu='...'
chu='...'

mingzi=['frame.protocols', 'tcp.srcport', 'tcp.dstport', 'udp.srcport', 'udp.dstport', 'icmp.type', 'icmp.code', 'tls.record.version', 'tls.record.content_type', 'tls.handshake', 'tls.handshake.type', 'dns.flags', 'http.request.method', 'http.response.code', 'num_0_0', 'timesum_0_0', 'ip.flags.df_0_0', 'ip.flags.mf_0_0', 'tcp.flags.ack_0_0', 'tcp.flags.urg_0_0', 'tcp.flags.push_0_0', 'tcp.flags.reset_0_0', 'tcp.flags.syn_0_0', 'tcp.flags.fin_0_0', 'frame.len_max_0_0', 'frame.len_min_0_0', 'frame.len_mean_0_0', 'frame.len_std_0_0', 'timedelta_max_0_0', 'timedelta_min_0_0', 'timedelta_mean_0_0', 'timedelta_std_0_0', 'ip.frag_offset_max_0_0', 'ip.frag_offset_min_0_0', 'ip.frag_offset_mean_0_0', 'ip.frag_offset_std_0_0', 'ip.ttl_max_0_0', 'ip.ttl_min_0_0', 'ip.ttl_mean_0_0', 'ip.ttl_std_0_0', 'tcp.window_size_max_0_0', 'tcp.window_size_min_0_0', 'tcp.window_size_mean_0_0', 'tcp.window_size_std_0_0', 'tcp.window_size_scalefactor_max_0_0', 'tcp.window_size_scalefactor_min_0_0', 'tcp.window_size_scalefactor_mean_0_0', 'tcp.window_size_scalefactor_std_0_0', 'tcp.window_size_value_max_0_0', 'tcp.window_size_value_min_0_0', 'tcp.window_size_value_mean_0_0', 'tcp.window_size_value_std_0_0', 'dns.count.queries_max_0_0', 'dns.count.queries_min_0_0', 'dns.count.queries_mean_0_0', 'dns.count.queries_std_0_0', 'num_0_1', 'timesum_0_1', 'ip.flags.df_0_1', 'ip.flags.mf_0_1', 'tcp.flags.ack_0_1', 'tcp.flags.urg_0_1', 'tcp.flags.push_0_1', 'tcp.flags.reset_0_1', 'tcp.flags.syn_0_1', 'tcp.flags.fin_0_1', 'frame.len_max_0_1', 'frame.len_min_0_1', 'frame.len_mean_0_1', 'frame.len_std_0_1', 'timedelta_max_0_1', 'timedelta_min_0_1', 'timedelta_mean_0_1', 'timedelta_std_0_1', 'ip.frag_offset_max_0_1', 'ip.frag_offset_min_0_1', 'ip.frag_offset_mean_0_1', 'ip.frag_offset_std_0_1', 'ip.ttl_max_0_1', 'ip.ttl_min_0_1', 'ip.ttl_mean_0_1', 'ip.ttl_std_0_1', 'tcp.window_size_max_0_1', 'tcp.window_size_min_0_1', 'tcp.window_size_mean_0_1', 'tcp.window_size_std_0_1', 'tcp.window_size_scalefactor_max_0_1', 'tcp.window_size_scalefactor_min_0_1', 'tcp.window_size_scalefactor_mean_0_1', 'tcp.window_size_scalefactor_std_0_1', 'tcp.window_size_value_max_0_1', 'tcp.window_size_value_min_0_1', 'tcp.window_size_value_mean_0_1', 'tcp.window_size_value_std_0_1', 'dns.count.queries_max_0_1', 'dns.count.queries_min_0_1', 'dns.count.queries_mean_0_1', 'dns.count.queries_std_0_1', 'num_0_2', 'timesum_0_2', 'ip.flags.df_0_2', 'ip.flags.mf_0_2', 'tcp.flags.ack_0_2', 'tcp.flags.urg_0_2', 'tcp.flags.push_0_2', 'tcp.flags.reset_0_2', 'tcp.flags.syn_0_2', 'tcp.flags.fin_0_2', 'frame.len_max_0_2', 'frame.len_min_0_2', 'frame.len_mean_0_2', 'frame.len_std_0_2', 'timedelta_max_0_2', 'timedelta_min_0_2', 'timedelta_mean_0_2', 'timedelta_std_0_2', 'ip.frag_offset_max_0_2', 'ip.frag_offset_min_0_2', 'ip.frag_offset_mean_0_2', 'ip.frag_offset_std_0_2', 'ip.ttl_max_0_2', 'ip.ttl_min_0_2', 'ip.ttl_mean_0_2', 'ip.ttl_std_0_2', 'tcp.window_size_max_0_2', 'tcp.window_size_min_0_2', 'tcp.window_size_mean_0_2', 'tcp.window_size_std_0_2', 'tcp.window_size_scalefactor_max_0_2', 'tcp.window_size_scalefactor_min_0_2', 'tcp.window_size_scalefactor_mean_0_2', 'tcp.window_size_scalefactor_std_0_2', 'tcp.window_size_value_max_0_2', 'tcp.window_size_value_min_0_2', 'tcp.window_size_value_mean_0_2', 'tcp.window_size_value_std_0_2', 'dns.count.queries_max_0_2', 'dns.count.queries_min_0_2', 'dns.count.queries_mean_0_2', 'dns.count.queries_std_0_2', 'num_1_0', 'timesum_1_0', 'ip.flags.df_1_0', 'ip.flags.mf_1_0', 'tcp.flags.ack_1_0', 'tcp.flags.urg_1_0', 'tcp.flags.push_1_0', 'tcp.flags.reset_1_0', 'tcp.flags.syn_1_0', 'tcp.flags.fin_1_0', 'frame.len_max_1_0', 'frame.len_min_1_0', 'frame.len_mean_1_0', 'frame.len_std_1_0', 'timedelta_max_1_0', 'timedelta_min_1_0', 'timedelta_mean_1_0', 'timedelta_std_1_0', 'ip.frag_offset_max_1_0', 'ip.frag_offset_min_1_0', 'ip.frag_offset_mean_1_0', 'ip.frag_offset_std_1_0', 'ip.ttl_max_1_0', 'ip.ttl_min_1_0', 'ip.ttl_mean_1_0', 'ip.ttl_std_1_0', 'tcp.window_size_max_1_0', 'tcp.window_size_min_1_0', 'tcp.window_size_mean_1_0', 'tcp.window_size_std_1_0', 'tcp.window_size_scalefactor_max_1_0', 'tcp.window_size_scalefactor_min_1_0', 'tcp.window_size_scalefactor_mean_1_0', 'tcp.window_size_scalefactor_std_1_0', 'tcp.window_size_value_max_1_0', 'tcp.window_size_value_min_1_0', 'tcp.window_size_value_mean_1_0', 'tcp.window_size_value_std_1_0', 'dns.count.queries_max_1_0', 'dns.count.queries_min_1_0', 'dns.count.queries_mean_1_0', 'dns.count.queries_std_1_0', 'num_1_1', 'timesum_1_1', 'ip.flags.df_1_1', 'ip.flags.mf_1_1', 'tcp.flags.ack_1_1', 'tcp.flags.urg_1_1', 'tcp.flags.push_1_1', 'tcp.flags.reset_1_1', 'tcp.flags.syn_1_1', 'tcp.flags.fin_1_1', 'frame.len_max_1_1', 'frame.len_min_1_1', 'frame.len_mean_1_1', 'frame.len_std_1_1', 'timedelta_max_1_1', 'timedelta_min_1_1', 'timedelta_mean_1_1', 'timedelta_std_1_1', 'ip.frag_offset_max_1_1', 'ip.frag_offset_min_1_1', 'ip.frag_offset_mean_1_1', 'ip.frag_offset_std_1_1', 'ip.ttl_max_1_1', 'ip.ttl_min_1_1', 'ip.ttl_mean_1_1', 'ip.ttl_std_1_1', 'tcp.window_size_max_1_1', 'tcp.window_size_min_1_1', 'tcp.window_size_mean_1_1', 'tcp.window_size_std_1_1', 'tcp.window_size_scalefactor_max_1_1', 'tcp.window_size_scalefactor_min_1_1', 'tcp.window_size_scalefactor_mean_1_1', 'tcp.window_size_scalefactor_std_1_1', 'tcp.window_size_value_max_1_1', 'tcp.window_size_value_min_1_1', 'tcp.window_size_value_mean_1_1', 'tcp.window_size_value_std_1_1', 'dns.count.queries_max_1_1', 'dns.count.queries_min_1_1', 'dns.count.queries_mean_1_1', 'dns.count.queries_std_1_1', 'num_1_2', 'timesum_1_2', 'ip.flags.df_1_2', 'ip.flags.mf_1_2', 'tcp.flags.ack_1_2', 'tcp.flags.urg_1_2', 'tcp.flags.push_1_2', 'tcp.flags.reset_1_2', 'tcp.flags.syn_1_2', 'tcp.flags.fin_1_2', 'frame.len_max_1_2', 'frame.len_min_1_2', 'frame.len_mean_1_2', 'frame.len_std_1_2', 'timedelta_max_1_2', 'timedelta_min_1_2', 'timedelta_mean_1_2', 'timedelta_std_1_2', 'ip.frag_offset_max_1_2', 'ip.frag_offset_min_1_2', 'ip.frag_offset_mean_1_2', 'ip.frag_offset_std_1_2', 'ip.ttl_max_1_2', 'ip.ttl_min_1_2', 'ip.ttl_mean_1_2', 'ip.ttl_std_1_2', 'tcp.window_size_max_1_2', 'tcp.window_size_min_1_2', 'tcp.window_size_mean_1_2', 'tcp.window_size_std_1_2', 'tcp.window_size_scalefactor_max_1_2', 'tcp.window_size_scalefactor_min_1_2', 'tcp.window_size_scalefactor_mean_1_2', 'tcp.window_size_scalefactor_std_1_2', 'tcp.window_size_value_max_1_2', 'tcp.window_size_value_min_1_2', 'tcp.window_size_value_mean_1_2', 'tcp.window_size_value_std_1_2', 'dns.count.queries_max_1_2', 'dns.count.queries_min_1_2', 'dns.count.queries_mean_1_2', 'dns.count.queries_std_1_2', 'num_2_0', 'timesum_2_0', 'ip.flags.df_2_0', 'ip.flags.mf_2_0', 'tcp.flags.ack_2_0', 'tcp.flags.urg_2_0', 'tcp.flags.push_2_0', 'tcp.flags.reset_2_0', 'tcp.flags.syn_2_0', 'tcp.flags.fin_2_0', 'frame.len_max_2_0', 'frame.len_min_2_0', 'frame.len_mean_2_0', 'frame.len_std_2_0', 'timedelta_max_2_0', 'timedelta_min_2_0', 'timedelta_mean_2_0', 'timedelta_std_2_0', 'ip.frag_offset_max_2_0', 'ip.frag_offset_min_2_0', 'ip.frag_offset_mean_2_0', 'ip.frag_offset_std_2_0', 'ip.ttl_max_2_0', 'ip.ttl_min_2_0', 'ip.ttl_mean_2_0', 'ip.ttl_std_2_0', 'tcp.window_size_max_2_0', 'tcp.window_size_min_2_0', 'tcp.window_size_mean_2_0', 'tcp.window_size_std_2_0', 'tcp.window_size_scalefactor_max_2_0', 'tcp.window_size_scalefactor_min_2_0', 'tcp.window_size_scalefactor_mean_2_0', 'tcp.window_size_scalefactor_std_2_0', 'tcp.window_size_value_max_2_0', 'tcp.window_size_value_min_2_0', 'tcp.window_size_value_mean_2_0', 'tcp.window_size_value_std_2_0', 'dns.count.queries_max_2_0', 'dns.count.queries_min_2_0', 'dns.count.queries_mean_2_0', 'dns.count.queries_std_2_0', 'num_2_1', 'timesum_2_1', 'ip.flags.df_2_1', 'ip.flags.mf_2_1', 'tcp.flags.ack_2_1', 'tcp.flags.urg_2_1', 'tcp.flags.push_2_1', 'tcp.flags.reset_2_1', 'tcp.flags.syn_2_1', 'tcp.flags.fin_2_1', 'frame.len_max_2_1', 'frame.len_min_2_1', 'frame.len_mean_2_1', 'frame.len_std_2_1', 'timedelta_max_2_1', 'timedelta_min_2_1', 'timedelta_mean_2_1', 'timedelta_std_2_1', 'ip.frag_offset_max_2_1', 'ip.frag_offset_min_2_1', 'ip.frag_offset_mean_2_1', 'ip.frag_offset_std_2_1', 'ip.ttl_max_2_1', 'ip.ttl_min_2_1', 'ip.ttl_mean_2_1', 'ip.ttl_std_2_1', 'tcp.window_size_max_2_1', 'tcp.window_size_min_2_1', 'tcp.window_size_mean_2_1', 'tcp.window_size_std_2_1', 'tcp.window_size_scalefactor_max_2_1', 'tcp.window_size_scalefactor_min_2_1', 'tcp.window_size_scalefactor_mean_2_1', 'tcp.window_size_scalefactor_std_2_1', 'tcp.window_size_value_max_2_1', 'tcp.window_size_value_min_2_1', 'tcp.window_size_value_mean_2_1', 'tcp.window_size_value_std_2_1', 'dns.count.queries_max_2_1', 'dns.count.queries_min_2_1', 'dns.count.queries_mean_2_1', 'dns.count.queries_std_2_1', 'num_2_2', 'timesum_2_2', 'ip.flags.df_2_2', 'ip.flags.mf_2_2', 'tcp.flags.ack_2_2', 'tcp.flags.urg_2_2', 'tcp.flags.push_2_2', 'tcp.flags.reset_2_2', 'tcp.flags.syn_2_2', 'tcp.flags.fin_2_2', 'frame.len_max_2_2', 'frame.len_min_2_2', 'frame.len_mean_2_2', 'frame.len_std_2_2', 'timedelta_max_2_2', 'timedelta_min_2_2', 'timedelta_mean_2_2', 'timedelta_std_2_2', 'ip.frag_offset_max_2_2', 'ip.frag_offset_min_2_2', 'ip.frag_offset_mean_2_2', 'ip.frag_offset_std_2_2', 'ip.ttl_max_2_2', 'ip.ttl_min_2_2', 'ip.ttl_mean_2_2', 'ip.ttl_std_2_2', 'tcp.window_size_max_2_2', 'tcp.window_size_min_2_2', 'tcp.window_size_mean_2_2', 'tcp.window_size_std_2_2', 'tcp.window_size_scalefactor_max_2_2', 'tcp.window_size_scalefactor_min_2_2', 'tcp.window_size_scalefactor_mean_2_2', 'tcp.window_size_scalefactor_std_2_2', 'tcp.window_size_value_max_2_2', 'tcp.window_size_value_min_2_2', 'tcp.window_size_value_mean_2_2', 'tcp.window_size_value_std_2_2', 'dns.count.queries_max_2_2', 'dns.count.queries_min_2_2', 'dns.count.queries_mean_2_2', 'dns.count.queries_std_2_2', 'num_3_0', 'timesum_3_0', 'ip.flags.df_3_0', 'ip.flags.mf_3_0', 'tcp.flags.ack_3_0', 'tcp.flags.urg_3_0', 'tcp.flags.push_3_0', 'tcp.flags.reset_3_0', 'tcp.flags.syn_3_0', 'tcp.flags.fin_3_0', 'frame.len_max_3_0', 'frame.len_min_3_0', 'frame.len_mean_3_0', 'frame.len_std_3_0', 'timedelta_max_3_0', 'timedelta_min_3_0', 'timedelta_mean_3_0', 'timedelta_std_3_0', 'ip.frag_offset_max_3_0', 'ip.frag_offset_min_3_0', 'ip.frag_offset_mean_3_0', 'ip.frag_offset_std_3_0', 'ip.ttl_max_3_0', 'ip.ttl_min_3_0', 'ip.ttl_mean_3_0', 'ip.ttl_std_3_0', 'tcp.window_size_max_3_0', 'tcp.window_size_min_3_0', 'tcp.window_size_mean_3_0', 'tcp.window_size_std_3_0', 'tcp.window_size_scalefactor_max_3_0', 'tcp.window_size_scalefactor_min_3_0', 'tcp.window_size_scalefactor_mean_3_0', 'tcp.window_size_scalefactor_std_3_0', 'tcp.window_size_value_max_3_0', 'tcp.window_size_value_min_3_0', 'tcp.window_size_value_mean_3_0', 'tcp.window_size_value_std_3_0', 'dns.count.queries_max_3_0', 'dns.count.queries_min_3_0', 'dns.count.queries_mean_3_0', 'dns.count.queries_std_3_0', 'num_3_1', 'timesum_3_1', 'ip.flags.df_3_1', 'ip.flags.mf_3_1', 'tcp.flags.ack_3_1', 'tcp.flags.urg_3_1', 'tcp.flags.push_3_1', 'tcp.flags.reset_3_1', 'tcp.flags.syn_3_1', 'tcp.flags.fin_3_1', 'frame.len_max_3_1', 'frame.len_min_3_1', 'frame.len_mean_3_1', 'frame.len_std_3_1', 'timedelta_max_3_1', 'timedelta_min_3_1', 'timedelta_mean_3_1', 'timedelta_std_3_1', 'ip.frag_offset_max_3_1', 'ip.frag_offset_min_3_1', 'ip.frag_offset_mean_3_1', 'ip.frag_offset_std_3_1', 'ip.ttl_max_3_1', 'ip.ttl_min_3_1', 'ip.ttl_mean_3_1', 'ip.ttl_std_3_1', 'tcp.window_size_max_3_1', 'tcp.window_size_min_3_1', 'tcp.window_size_mean_3_1', 'tcp.window_size_std_3_1', 'tcp.window_size_scalefactor_max_3_1', 'tcp.window_size_scalefactor_min_3_1', 'tcp.window_size_scalefactor_mean_3_1', 'tcp.window_size_scalefactor_std_3_1', 'tcp.window_size_value_max_3_1', 'tcp.window_size_value_min_3_1', 'tcp.window_size_value_mean_3_1', 'tcp.window_size_value_std_3_1', 'dns.count.queries_max_3_1', 'dns.count.queries_min_3_1', 'dns.count.queries_mean_3_1', 'dns.count.queries_std_3_1', 'num_3_2', 'timesum_3_2', 'ip.flags.df_3_2', 'ip.flags.mf_3_2', 'tcp.flags.ack_3_2', 'tcp.flags.urg_3_2', 'tcp.flags.push_3_2', 'tcp.flags.reset_3_2', 'tcp.flags.syn_3_2', 'tcp.flags.fin_3_2', 'frame.len_max_3_2', 'frame.len_min_3_2', 'frame.len_mean_3_2', 'frame.len_std_3_2', 'timedelta_max_3_2', 'timedelta_min_3_2', 'timedelta_mean_3_2', 'timedelta_std_3_2', 'ip.frag_offset_max_3_2', 'ip.frag_offset_min_3_2', 'ip.frag_offset_mean_3_2', 'ip.frag_offset_std_3_2', 'ip.ttl_max_3_2', 'ip.ttl_min_3_2', 'ip.ttl_mean_3_2', 'ip.ttl_std_3_2', 'tcp.window_size_max_3_2', 'tcp.window_size_min_3_2', 'tcp.window_size_mean_3_2', 'tcp.window_size_std_3_2', 'tcp.window_size_scalefactor_max_3_2', 'tcp.window_size_scalefactor_min_3_2', 'tcp.window_size_scalefactor_mean_3_2', 'tcp.window_size_scalefactor_std_3_2', 'tcp.window_size_value_max_3_2', 'tcp.window_size_value_min_3_2', 'tcp.window_size_value_mean_3_2', 'tcp.window_size_value_std_3_2', 'dns.count.queries_max_3_2', 'dns.count.queries_min_3_2', 'dns.count.queries_mean_3_2', 'dns.count.queries_std_3_2', 'num_4_0', 'timesum_4_0', 'ip.flags.df_4_0', 'ip.flags.mf_4_0', 'tcp.flags.ack_4_0', 'tcp.flags.urg_4_0', 'tcp.flags.push_4_0', 'tcp.flags.reset_4_0', 'tcp.flags.syn_4_0', 'tcp.flags.fin_4_0', 'frame.len_max_4_0', 'frame.len_min_4_0', 'frame.len_mean_4_0', 'frame.len_std_4_0', 'timedelta_max_4_0', 'timedelta_min_4_0', 'timedelta_mean_4_0', 'timedelta_std_4_0', 'ip.frag_offset_max_4_0', 'ip.frag_offset_min_4_0', 'ip.frag_offset_mean_4_0', 'ip.frag_offset_std_4_0', 'ip.ttl_max_4_0', 'ip.ttl_min_4_0', 'ip.ttl_mean_4_0', 'ip.ttl_std_4_0', 'tcp.window_size_max_4_0', 'tcp.window_size_min_4_0', 'tcp.window_size_mean_4_0', 'tcp.window_size_std_4_0', 'tcp.window_size_scalefactor_max_4_0', 'tcp.window_size_scalefactor_min_4_0', 'tcp.window_size_scalefactor_mean_4_0', 'tcp.window_size_scalefactor_std_4_0', 'tcp.window_size_value_max_4_0', 'tcp.window_size_value_min_4_0', 'tcp.window_size_value_mean_4_0', 'tcp.window_size_value_std_4_0', 'dns.count.queries_max_4_0', 'dns.count.queries_min_4_0', 'dns.count.queries_mean_4_0', 'dns.count.queries_std_4_0', 'num_4_1', 'timesum_4_1', 'ip.flags.df_4_1', 'ip.flags.mf_4_1', 'tcp.flags.ack_4_1', 'tcp.flags.urg_4_1', 'tcp.flags.push_4_1', 'tcp.flags.reset_4_1', 'tcp.flags.syn_4_1', 'tcp.flags.fin_4_1', 'frame.len_max_4_1', 'frame.len_min_4_1', 'frame.len_mean_4_1', 'frame.len_std_4_1', 'timedelta_max_4_1', 'timedelta_min_4_1', 'timedelta_mean_4_1', 'timedelta_std_4_1', 'ip.frag_offset_max_4_1', 'ip.frag_offset_min_4_1', 'ip.frag_offset_mean_4_1', 'ip.frag_offset_std_4_1', 'ip.ttl_max_4_1', 'ip.ttl_min_4_1', 'ip.ttl_mean_4_1', 'ip.ttl_std_4_1', 'tcp.window_size_max_4_1', 'tcp.window_size_min_4_1', 'tcp.window_size_mean_4_1', 'tcp.window_size_std_4_1', 'tcp.window_size_scalefactor_max_4_1', 'tcp.window_size_scalefactor_min_4_1', 'tcp.window_size_scalefactor_mean_4_1', 'tcp.window_size_scalefactor_std_4_1', 'tcp.window_size_value_max_4_1', 'tcp.window_size_value_min_4_1', 'tcp.window_size_value_mean_4_1', 'tcp.window_size_value_std_4_1', 'dns.count.queries_max_4_1', 'dns.count.queries_min_4_1', 'dns.count.queries_mean_4_1', 'dns.count.queries_std_4_1', 'num_4_2', 'timesum_4_2', 'ip.flags.df_4_2', 'ip.flags.mf_4_2', 'tcp.flags.ack_4_2', 'tcp.flags.urg_4_2', 'tcp.flags.push_4_2', 'tcp.flags.reset_4_2', 'tcp.flags.syn_4_2', 'tcp.flags.fin_4_2', 'frame.len_max_4_2', 'frame.len_min_4_2', 'frame.len_mean_4_2', 'frame.len_std_4_2', 'timedelta_max_4_2', 'timedelta_min_4_2', 'timedelta_mean_4_2', 'timedelta_std_4_2', 'ip.frag_offset_max_4_2', 'ip.frag_offset_min_4_2', 'ip.frag_offset_mean_4_2', 'ip.frag_offset_std_4_2', 'ip.ttl_max_4_2', 'ip.ttl_min_4_2', 'ip.ttl_mean_4_2', 'ip.ttl_std_4_2', 'tcp.window_size_max_4_2', 'tcp.window_size_min_4_2', 'tcp.window_size_mean_4_2', 'tcp.window_size_std_4_2', 'tcp.window_size_scalefactor_max_4_2', 'tcp.window_size_scalefactor_min_4_2', 'tcp.window_size_scalefactor_mean_4_2', 'tcp.window_size_scalefactor_std_4_2', 'tcp.window_size_value_max_4_2', 'tcp.window_size_value_min_4_2', 'tcp.window_size_value_mean_4_2', 'tcp.window_size_value_std_4_2', 'dns.count.queries_max_4_2', 'dns.count.queries_min_4_2', 'dns.count.queries_mean_4_2', 'dns.count.queries_std_4_2', 'num_5_0', 'timesum_5_0', 'ip.flags.df_5_0', 'ip.flags.mf_5_0', 'tcp.flags.ack_5_0', 'tcp.flags.urg_5_0', 'tcp.flags.push_5_0', 'tcp.flags.reset_5_0', 'tcp.flags.syn_5_0', 'tcp.flags.fin_5_0', 'frame.len_max_5_0', 'frame.len_min_5_0', 'frame.len_mean_5_0', 'frame.len_std_5_0', 'timedelta_max_5_0', 'timedelta_min_5_0', 'timedelta_mean_5_0', 'timedelta_std_5_0', 'ip.frag_offset_max_5_0', 'ip.frag_offset_min_5_0', 'ip.frag_offset_mean_5_0', 'ip.frag_offset_std_5_0', 'ip.ttl_max_5_0', 'ip.ttl_min_5_0', 'ip.ttl_mean_5_0', 'ip.ttl_std_5_0', 'tcp.window_size_max_5_0', 'tcp.window_size_min_5_0', 'tcp.window_size_mean_5_0', 'tcp.window_size_std_5_0', 'tcp.window_size_scalefactor_max_5_0', 'tcp.window_size_scalefactor_min_5_0', 'tcp.window_size_scalefactor_mean_5_0', 'tcp.window_size_scalefactor_std_5_0', 'tcp.window_size_value_max_5_0', 'tcp.window_size_value_min_5_0', 'tcp.window_size_value_mean_5_0', 'tcp.window_size_value_std_5_0', 'dns.count.queries_max_5_0', 'dns.count.queries_min_5_0', 'dns.count.queries_mean_5_0', 'dns.count.queries_std_5_0', 'num_5_1', 'timesum_5_1', 'ip.flags.df_5_1', 'ip.flags.mf_5_1', 'tcp.flags.ack_5_1', 'tcp.flags.urg_5_1', 'tcp.flags.push_5_1', 'tcp.flags.reset_5_1', 'tcp.flags.syn_5_1', 'tcp.flags.fin_5_1', 'frame.len_max_5_1', 'frame.len_min_5_1', 'frame.len_mean_5_1', 'frame.len_std_5_1', 'timedelta_max_5_1', 'timedelta_min_5_1', 'timedelta_mean_5_1', 'timedelta_std_5_1', 'ip.frag_offset_max_5_1', 'ip.frag_offset_min_5_1', 'ip.frag_offset_mean_5_1', 'ip.frag_offset_std_5_1', 'ip.ttl_max_5_1', 'ip.ttl_min_5_1', 'ip.ttl_mean_5_1', 'ip.ttl_std_5_1', 'tcp.window_size_max_5_1', 'tcp.window_size_min_5_1', 'tcp.window_size_mean_5_1', 'tcp.window_size_std_5_1', 'tcp.window_size_scalefactor_max_5_1', 'tcp.window_size_scalefactor_min_5_1', 'tcp.window_size_scalefactor_mean_5_1', 'tcp.window_size_scalefactor_std_5_1', 'tcp.window_size_value_max_5_1', 'tcp.window_size_value_min_5_1', 'tcp.window_size_value_mean_5_1', 'tcp.window_size_value_std_5_1', 'dns.count.queries_max_5_1', 'dns.count.queries_min_5_1', 'dns.count.queries_mean_5_1', 'dns.count.queries_std_5_1', 'num_5_2', 'timesum_5_2', 'ip.flags.df_5_2', 'ip.flags.mf_5_2', 'tcp.flags.ack_5_2', 'tcp.flags.urg_5_2', 'tcp.flags.push_5_2', 'tcp.flags.reset_5_2', 'tcp.flags.syn_5_2', 'tcp.flags.fin_5_2', 'frame.len_max_5_2', 'frame.len_min_5_2', 'frame.len_mean_5_2', 'frame.len_std_5_2', 'timedelta_max_5_2', 'timedelta_min_5_2', 'timedelta_mean_5_2', 'timedelta_std_5_2', 'ip.frag_offset_max_5_2', 'ip.frag_offset_min_5_2', 'ip.frag_offset_mean_5_2', 'ip.frag_offset_std_5_2', 'ip.ttl_max_5_2', 'ip.ttl_min_5_2', 'ip.ttl_mean_5_2', 'ip.ttl_std_5_2', 'tcp.window_size_max_5_2', 'tcp.window_size_min_5_2', 'tcp.window_size_mean_5_2', 'tcp.window_size_std_5_2', 'tcp.window_size_scalefactor_max_5_2', 'tcp.window_size_scalefactor_min_5_2', 'tcp.window_size_scalefactor_mean_5_2', 'tcp.window_size_scalefactor_std_5_2', 'tcp.window_size_value_max_5_2', 'tcp.window_size_value_min_5_2', 'tcp.window_size_value_mean_5_2', 'tcp.window_size_value_std_5_2', 'dns.count.queries_max_5_2', 'dns.count.queries_min_5_2', 'dns.count.queries_mean_5_2', 'dns.count.queries_std_5_2']

lie=['frame.len','timedelta','ip.frag_offset','ip.ttl','tcp.window_size','tcp.window_size_scalefactor','tcp.window_size_value','dns.count.queries']

shulie=['frame.protocols','tcp.srcport','tcp.dstport','udp.srcport','udp.dstport','icmp.type','icmp.code','tls.record.version','tls.record.content_type','tls.handshake','tls.handshake.type','dns.flags','http.request.method','http.response.code']

for i1 in os.listdir(lu):
  w1=lu+i1+'/'
  c1=chu+i1+'.csv'
  p=pd.DataFrame()
  for i2 in os.listdir(w1):
    w2=w1+i2
    fea=[]
    data=pd.read_csv(w2)
    data=data.fillna(0)
    firip=data['ip.src'][0]
    data['dir']=-1
    data['dir'][data['ip.src']==firip]=0
    data['dir'][data['ip.src']!=firip]=1
    firtime=data['frame.time_epoch'][0]
    shiflag=1
    for shude in shulie:
      prolie=np.ravel(data[shude]).tolist()
      ci=Counter(prolie)
      fea.append(dict(ci))
    for shi in range(6):
      for fang in range(3):
        if shi==0:
          qu=data.copy()
        if shi==1:
          qu=data[data['frame.time_epoch']<firtime+0.1].copy()
        if shi==2:
          quz=data[data['frame.time_epoch']>=firtime+0.1].copy()
          qu=quz[quz['frame.time_epoch']<firtime+0.5].copy()
        if shi==3:
          quz=data[data['frame.time_epoch']>=firtime+0.5].copy()
          qu=quz[quz['frame.time_epoch']<firtime+1.5].copy()
        ...